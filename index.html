<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>БУНКЕР - Постапокалиптическая игра выживания</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Roboto+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --dark-bg: #0d0d0d;
            --metal-dark: #1a1a1a;
            --metal-medium: #2d2d2d;
            --metal-light: #3d3d3d;
            --rust: #c0392b;
            --rust-light: #e74c3c;
            --warning: #f39c12;
            --screen-green: #27ae60;
            --screen-blue: #2980b9;
            --text-light: #ecf0f1;
            --text-dim: #bdc3c7;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto Mono', monospace;
        }
        
        body {
            background: linear-gradient(135deg, var(--dark-bg) 0%, #1a1a2e 100%);
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(45, 45, 45, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(45, 45, 45, 0.1) 0%, transparent 40%),
                repeating-linear-gradient(
                    0deg,
                    rgba(0, 0, 0, 0.15),
                    rgba(0, 0, 0, 0.15) 1px,
                    transparent 1px,
                    transparent 2px
                );
            pointer-events: none;
            z-index: -1;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 15px;
            position: relative;
            z-index: 1;
        }
        
        .screen {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }
        
        .active {
            display: block;
        }
        
        .header {
            text-align: center;
            margin-bottom: 25px;
            padding: 25px 0 15px;
            position: relative;
            border-bottom: 1px solid rgba(195, 155, 60, 0.2);
        }
        
        .logo {
            font-size: 3rem;
            font-weight: bold;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 3px;
            background: linear-gradient(to right, #c3943c, #f1c40f, #c3943c);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
            text-shadow: 0 0 15px rgba(241, 196, 15, 0.3);
            position: relative;
        }
        
        .logo::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 2px;
            background: linear-gradient(to right, transparent, #c3943c, transparent);
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.8;
            margin-top: 10px;
            color: var(--text-dim);
            letter-spacing: 1px;
        }
        
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 15px 0;
            border: none;
            border-radius: 0;
            background: linear-gradient(to right, var(--metal-medium), var(--metal-dark));
            color: var(--text-light);
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-align: center;
            border: 1px solid rgba(195, 155, 60, 0.3);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
        }
        
        .btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(241, 196, 15, 0.2), transparent);
            transition: 0.5s;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.7);
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:active {
            transform: translateY(1px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        .btn-secondary {
            background: linear-gradient(to right, #2c3e50, #1a2a3a);
            border: 1px solid rgba(52, 152, 219, 0.3);
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid #c3943c;
            color: #c3943c;
        }
        
        .btn-small {
            padding: 8px 15px;
            font-size: 0.9rem;
        }
        
        .btn-danger {
            background: linear-gradient(to right, #c0392b, #8e281e);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .card {
            background: rgba(30, 30, 30, 0.7);
            border-radius: 0;
            padding: 25px;
            margin-bottom: 25px;
            position: relative;
            border: 1px solid rgba(195, 155, 60, 0.2);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }
        
        .card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #c3943c, #f1c40f, #c3943c);
        }
        
        .card-title {
            font-size: 1.6rem;
            margin-bottom: 20px;
            color: #c3943c;
            text-align: center;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        .page-nav {
            display: flex;
            justify-content: space-between;
            margin: 25px 0 10px;
        }
        
        .page-number {
            text-align: center;
            font-size: 0.9rem;
            opacity: 0.7;
            margin: 10px 0;
            color: var(--text-dim);
        }
        
        .slider-container {
            margin: 25px 0;
            position: relative;
            padding: 10px 0;
        }
        
        .slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, var(--metal-dark), var(--metal-medium));
            outline: none;
            border-radius: 0;
            border: 1px solid rgba(195, 155, 60, 0.3);
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 0;
            background: #c3943c;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(241, 196, 15, 0.5);
            border: 2px solid #1a1a1a;
        }
        
        .slider-value {
            text-align: center;
            font-size: 1.8rem;
            font-weight: bold;
            margin: 15px 0;
            color: #c3943c;
            font-family: 'Orbitron', sans-serif;
        }
        
        .character-card {
            background: linear-gradient(to bottom, #1e1e1e, #1a1a1a);
            border-radius: 0;
            padding: 20px;
            margin: 15px 0;
            position: relative;
            border: 1px solid rgba(195, 155, 60, 0.3);
        }
        
        .character-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #c3943c, #f1c40f, #c3943c);
        }
        
        .character-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(195, 155, 60, 0.2);
        }
        
        .character-title {
            font-weight: bold;
            font-size: 1.3rem;
            color: #c3943c;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .character-info {
            margin-bottom: 15px;
            padding: 15px;
            border-left: 3px solid #c3943c;
            background: rgba(0, 0, 0, 0.2);
            position: relative;
        }
        
        .character-info:not(:last-child) {
            margin-bottom: 20px;
        }
        
        .info-label {
            font-weight: bold;
            color: #c3943c;
            display: block;
            margin-bottom: 8px;
            text-transform: uppercase;
            font-size: 0.9rem;
            letter-spacing: 1px;
        }
        
        .tab-container {
            display: flex;
            margin-bottom: 25px;
            border: 1px solid rgba(195, 155, 60, 0.3);
        }
        
        .tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: var(--metal-dark);
            cursor: pointer;
            transition: background 0.3s;
            font-weight: 500;
            border-right: 1px solid rgba(195, 155, 60, 0.3);
        }
        
        .tab:last-child {
            border-right: none;
        }
        
        .tab.active {
            background: #c3943c;
            color: #1a1a1a;
            font-weight: bold;
        }
        
        .player-card {
            background: rgba(40, 40, 40, 0.8);
            border-radius: 0;
            padding: 15px;
            margin: 15px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(195, 155, 60, 0.2);
        }
        
        .player-number {
            background: #c3943c;
            width: 35px;
            height: 35px;
            border-radius: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #1a1a1a;
            font-family: 'Orbitron', sans-serif;
        }
        
        .footer {
            text-align: center;
            padding: 25px;
            margin-top: 20px;
            border-top: 1px solid rgba(195, 155, 60, 0.2);
        }
        
        .threat-card {
            background: rgba(195, 60, 60, 0.15);
            border-radius: 0;
            padding: 25px;
            margin: 25px 0;
            border: 1px solid rgba(231, 76, 60, 0.5);
            position: relative;
        }
        
        .threat-card::before {
            content: "⚠";
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2rem;
            color: #e74c3c;
            background: var(--metal-dark);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid #e74c3c;
        }
        
        .threat-title {
            color: #e74c3c;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Orbitron', sans-serif;
        }
        
        .bunker-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        
        .info-box {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 0;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(195, 155, 60, 0.2);
        }
        
        .info-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .info-value {
            font-size: 1.3rem;
            font-weight: bold;
            margin-top: 8px;
            color: #c3943c;
            font-family: 'Orbitron', sans-serif;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes scanline {
            0% {
                transform: translateY(-100%);
            }
            100% {
                transform: translateY(100%);
            }
        }
        
        .player-slider {
            display: flex;
            justify-content: center;
            margin: 25px 0;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .player-dot {
            width: 45px;
            height: 45px;
            background: var(--metal-medium);
            border-radius: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            font-size: 1.2rem;
            border: 1px solid rgba(195, 155, 60, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .player-dot::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(120deg, transparent, rgba(195, 155, 60, 0.1), transparent);
            transform: translateX(-100%);
        }
        
        .player-dot:hover::before {
            animation: shine 1.5s;
        }
        
        .player-dot.active {
            background: #c3943c;
            color: #1a1a1a;
            transform: scale(1.1);
            border: 1px solid #f1c40f;
            box-shadow: 0 0 15px rgba(241, 196, 15, 0.5);
        }
        
        @keyframes shine {
            100% {
                transform: translateX(100%);
            }
        }
        
        .back-btn {
            position: absolute;
            left: 0;
            top: 25px;
            background: none;
            border: none;
            color: #c3943c;
            font-size: 1.3rem;
            cursor: pointer;
            padding: 5px;
            border: 1px solid rgba(195, 155, 60, 0.3);
        }
        
        .hidden {
            display: none;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 10, 10, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal-content {
            background: var(--metal-dark);
            border-radius: 0;
            padding: 30px;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            width: 100%;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
            position: relative;
            border: 1px solid #c3943c;
            animation: modalAppear 0.5s ease-out;
        }
        
        .modal-content::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #c3943c, #f1c40f, #c3943c);
        }
        
        @keyframes modalAppear {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: #c3943c;
            font-size: 1.8rem;
            cursor: pointer;
            width: 35px;
            height: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid rgba(195, 155, 60, 0.3);
        }
        
        .modal-title {
            text-align: center;
            margin-bottom: 25px;
            color: #c3943c;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 1.8rem;
        }
        
        .modal-list {
            max-height: 60vh;
            overflow-y: auto;
            padding: 10px;
        }
        
        .modal-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 0;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 3px solid #c3943c;
            position: relative;
        }
        
        .modal-item::before {
            content: "■";
            position: absolute;
            top: 20px;
            left: -10px;
            color: #c3943c;
            font-size: 1.2rem;
        }
        
        .modal-item-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #c3943c;
            font-size: 1.2rem;
        }
        
        .number-selector {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
        }
        
        .number-option {
            width: 55px;
            height: 55px;
            border-radius: 0;
            background: var(--metal-medium);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.4rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid rgba(195, 155, 60, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .number-option::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(120deg, transparent, rgba(195, 155, 60, 0.1), transparent);
            transform: translateX(-100%);
        }
        
        .number-option:hover::before {
            animation: shine 1.5s;
        }
        
        .number-option:hover {
            transform: scale(1.1);
        }
        
        .number-option.selected {
            background: #c3943c;
            color: #1a1a1a;
            border-color: #f1c40f;
            box-shadow: 0 0 15px rgba(241, 196, 15, 0.5);
        }
        
        .finish-player-list {
            max-height: 50vh;
            overflow-y: auto;
            margin: 25px 0;
        }
        
        .finish-player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 0;
            border: 1px solid rgba(195, 155, 60, 0.3);
        }
        
        /* Эффект сканирующей линии */
        .scanline {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 10px;
            background: linear-gradient(to bottom, transparent, rgba(195, 155, 60, 0.2), transparent);
            z-index: 9999;
            pointer-events: none;
            animation: scanline 8s linear infinite;
        }
        
        /* Мобильные стили */
        @media (max-width: 480px) {
            .logo {
                font-size: 2.2rem;
            }
            
            .btn {
                padding: 12px;
                font-size: 1rem;
            }
            
            .card {
                padding: 20px;
            }
            
            .player-dot {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
            }
            
            .number-option {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }
            
            .modal-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="scanline"></div>
    
    <div class="container">
        <!-- Главный экран -->
        <div id="mainScreen" class="screen active">
            <div class="header">
                <div class="logo">БУНКЕР</div>
                <div class="subtitle">Выживи в постапокалиптическом мире</div>
            </div>
            
            <div class="card">
                <button id="createGameBtn" class="btn">Создать игру</button>
                <button id="howToPlayBtn" class="btn btn-secondary">Как играть?</button>
            </div>
            
            <div class="card">
                <h3>Последние игры</h3>
                <p>У вас пока нет завершенных игр</p>
            </div>
            
            <div class="footer">
                <button id="bugReportBtn" class="btn btn-outline">Сообщить о проблеме</button>
            </div>
        </div>
        
        <!-- Экран "Как играть" -->
        <div id="howToPlayScreen" class="screen">
            <div class="header">
                <button class="back-btn">←</button>
                <h2>Как играть?</h2>
            </div>
            
            <div class="tab-container">
                <div id="introTab" class="tab active">Введение</div>
                <div id="gameplayTab" class="tab">Ход игры</div>
            </div>
            
            <div id="introContent">
                <div id="introPage1" class="card">
                    <div class="page-number">Страница 1/3</div>
                    <h3 class="card-title">Что случилось</h3>
                    <p>Катастрофа планетарных масштабов превратила Землю в постапокалиптический мир. Выживание на поверхности не представляется возможным ни в каком виде.</p>
                </div>
                
                <div id="introPage2" class="card hidden">
                    <div class="page-number">Страница 2/3</div>
                    <h3 class="card-title">Как выжить</h3>
                    <p>Чтобы выжить, вам придётся переждать конец света в бункере. Вот только... не один вы ищете убежища. Около дверей бункера собрались самые разные люди, а мест и ресурсов в нём хватит лишь на половину.</p>
                </div>
                
                <div id="introPage3" class="card hidden">
                    <div class="page-number">Страница 3/3</div>
                    <h3 class="card-title">Я попаду в бункер!</h3>
                    <p>Сыграйте роль одного из немногих выживших, убедите других в своей полезности и Выживите в новой суровой реальности!</p>
                </div>
                
                <div class="page-nav">
                    <button id="introPrevBtn" class="btn btn-outline" disabled>Назад</button>
                    <button id="introNextBtn" class="btn">Далее</button>
                </div>
            </div>
            
            <div id="gameplayContent" class="hidden">
                <div id="gameplayPage1" class="card">
                    <div class="page-number">Страница 1/8</div>
                    <h3 class="card-title">До игры</h3>
                    <p>После того как вы создали игру, вы можете скинуть карточку каждого персонажа ему в телеграмм, для более удобной игры.</p>
                </div>
                
                <div id="gameplayPage2" class="card hidden">
                    <div class="page-number">Страница 2/8</div>
                    <h3 class="card-title">Экран катастрофы</h3>
                    <p>На экране катастрофы вы можете ознакомиться с апокалипсисом, от которого вам придётся укрываться. А также узнать информацию о самом бункере (описание, количество мест, доступные ресурсы и время, которое вы проведёте в бункере)</p>
                </div>
                
                <div id="gameplayPage3" class="card hidden">
                    <div class="page-number">Страница 3/8</div>
                    <h3 class="card-title">Ваш персонаж</h3>
                    <p>На экране персонажа вы увидите характеристики, которые вам предстоит открывать по ходу игры, чтобы доказать, что вы будете полезны в бункере. А также две карточки - действия и условия, с помощью которых вы сможете изменить ход игры в свою пользу</p>
                </div>
                
                <div id="gameplayPage4" class="card hidden">
                    <div class="page-number">Страница 4/8</div>
                    <h3 class="card-title">Карточки</h3>
                    <p>Карточка действия может быть использована игроком в любой момент игры. Карточка условия должна быть использована игроком как только условие написанное на ней выполнится.</p>
                </div>
                
                <div id="gameplayPage5" class="card hidden">
                    <div class="page-number">Страница 5/8</div>
                    <h3 class="card-title">Вскрытие характеристик</h3>
                    <p>На каждом круге все игроки по очереди вскрывают одинаковое количество характеристик(Количество можете выбрать сами, хотите ли вы более спокойную игру или более быструю) Профессия обязательно раскрывается на первом круге</p>
                </div>
                
                <div id="gameplayPage6" class="card hidden">
                    <div class="page-number">Страница 6/8</div>
                    <h3 class="card-title">Обсуждение</h3>
                    <p>После каждого круга проходит обсуждение. Мы рекомендуем Давать каждому игроку личную минуту, от которой можно отказаться в случае, если игроку нечего сказать.</p>
                </div>
                
                <div id="gameplayPage7" class="card hidden">
                    <div class="page-number">Страница 7/8</div>
                    <h3 class="card-title">Голосование</h3>
                    <p>После обсуждения игроки голосуют за того/тех, кто точно не пройдёт в бункер.</p>
                </div>
                
                <div id="gameplayPage8" class="card hidden">
                    <div class="page-number">Страница 8/8</div>
                    <h3 class="card-title">Окончание игры</h3>
                    <p>Игра продолжается до тех пор, пока количество игроков не будет совпадать с количеством мест в бункере. После игры вы можете посмотреть концовку - событие которое проверит команду попавших в бункер на прочность.</p>
                </div>
                
                <div class="page-nav">
                    <button id="gameplayPrevBtn" class="btn btn-outline" disabled>Назад</button>
                    <button id="gameplayNextBtn" class="btn">Далее</button>
                </div>
            </div>
        </div>
        
        <!-- Экран создания игры -->
        <div id="createGameScreen" class="screen">
            <div class="header">
                <button class="back-btn">←</button>
                <h2>Создать игру</h2>
            </div>
            
            <div class="card">
                <h3 class="card-title">Количество игроков</h3>
                <div class="slider-container">
                    <input type="range" id="playerCountSlider" class="slider" min="4" max="22" value="12">
                    <div id="playerCountValue" class="slider-value">12</div>
                </div>
                <p>Рекомендуем 10-14 игроков</p>
            </div>
            
            <div class="card">
                <h3 class="card-title">Настройки игры</h3>
                <button id="apocalypseListBtn" class="btn btn-secondary">Список апокалипсисов</button>
                <button id="bunkerListBtn" class="btn btn-secondary">Список бункеров</button>
            </div>
            
            <button id="createGameNextBtn" class="btn">Далее</button>
        </div>
        
        <!-- Экран выбора персонажа -->
        <div id="chooseCharacterScreen" class="screen">
            <div class="header">
                <button class="back-btn">←</button>
                <h2>Выберите номер персонажа</h2>
            </div>
            
            <div class="card">
                <div class="number-selector" id="numberSelector">
                    <!-- Номера будут добавлены динамически -->
                </div>
                
                <div class="character-card">
                    <div class="character-header">
                        <div class="character-title">Игрок <span id="characterNumDisplay">1</span></div>
                    </div>
                </div>
                
                <label class="player-card">
                    <div>Я буду наблюдателем</div>
                    <div>
                        <input type="checkbox" id="observerCheckbox">
                    </div>
                </label>
            </div>
            
            <button id="chooseCharacterNextBtn" class="btn">Далее</button>
        </div>
        
        <!-- Экран рассылки карточек -->
        <div id="shareCardsScreen" class="screen">
            <div class="header">
                <button class="back-btn">←</button>
                <h2>Рассылка карточек</h2>
            </div>
            
            <div class="card">
                <p>Отправьте каждому игроку его карточку персонажа через Telegram:</p>
                
                <div id="playersList">
                    <!-- Список игроков будет сгенерирован динамически -->
                </div>
            </div>
            
            <button id="startGameBtn" class="btn">Начать игру</button>
        </div>
        
        <!-- Экран игры -->
        <div id="gameScreen" class="screen">
            <div class="header">
                <button class="back-btn">←</button>
                <h2>Игра</h2>
            </div>
            
            <!-- Экран катастрофы и бункера -->
            <div id="apocalypseBunkerScreen" class="card">
                <h3 class="card-title">АПОКАЛИПСИС</h3>
                <p id="apocalypseDescription">После серии сейсмических активностей на мир обрушились цунами и землетрясения, разрушившие атомные электростанции по всему миру.</p>
                
                <h3 class="card-title" style="margin-top: 20px;">БУНКЕР</h3>
                <div class="bunker-info">
                    <div class="info-box">
                        <div class="info-label">Название</div>
                        <div id="bunkerName" class="info-value">Гора Бора</div>
                    </div>
                    <div class="info-box">
                        <div class="info-label">Размер</div>
                        <div id="bunkerSize" class="info-value">500 m²</div>
                    </div>
                    <div class="info-box">
                        <div class="info-label">Места</div>
                        <div id="bunkerSlots" class="info-value">11</div>
                    </div>
                    <div class="info-box">
                        <div class="info-label">Время</div>
                        <div id="bunkerTime" class="info-value">1 мес.</div>
                    </div>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Описание:</span> 
                    <p id="bunkerDescription">Современный бункер, ранее использованный как склад для овощей. Использовался как локация фильма.</p>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Местоположение:</span> 
                    <p id="bunkerLocation">Болото</p>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Ресурсы:</span> 
                    <p id="bunkerResources">Запас воды на 2 месяца, консервы на 2 месяца, 1 ноутбук</p>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Слабости:</span> 
                    <p id="bunkerWeaknesses">Расположен на склоне (риск обвала), неисправная вентиляция</p>
                </div>
                
                <button id="hideApocalypseBtn" class="btn btn-outline" style="margin-top: 15px;">Скрыть</button>
            </div>
            
            <!-- Карта персонажа -->
            <div id="characterCardScreen" class="card">
                <div class="character-header">
                    <h3 class="character-title">Игрок <span id="playerNum">1</span>: <span id="playerProfession">Дегустатор</span></h3>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Био. Характеристики</span>
                    <div>Возраст: <span id="playerAge">22 год</span></div>
                    <div>Пол: <span id="playerGender">Женщина</span></div>
                    <div>Ориентация: <span id="playerOrientation">гетеросексуальная</span></div>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Состояние Здоровья</span>
                    <div><span id="playerHealth">Идеально здоров</span></div>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Характер</span>
                    <div><span id="playerCharacter">Оптимистичный</span></div>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Хобби</span>
                    <div><span id="playerHobby">Вязание</span></div>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Фобия</span>
                    <div><span id="playerPhobia">Зоофобия – боязнь животных</span></div>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Доп. Инфа</span>
                    <div><span id="playerExtra">Знает 5 языков</span></div>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Знание</span>
                    <div><span id="playerKnowledge">Знает место с солнечными батареями</span></div>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Багаж</span>
                    <div><span id="playerLuggage">Гитара</span></div>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Карта действия</span>
                    <div><span id="playerActionCard">Вылечить любого игрока от болезни</span></div>
                </div>
                
                <div class="character-info">
                    <span class="info-label">Карта условия</span>
                    <div><span id="playerConditionCard">Если вас выгонят, в бункере заведутся крысы</span></div>
                </div>
                
                <div class="player-slider" id="playerSlider">
                    <!-- Кнопки для игроков будут добавлены динамически -->
                </div>
                
                <button id="showApocalypseBtn" class="btn btn-outline" style="margin-top: 15px;">Показать апокалипсис</button>
                <button id="finishBtn" class="btn" style="margin-top: 10px;">Финиш</button>
            </div>
        </div>
    </div>

    <!-- Модальные окна -->
    <div id="apocalypseModal" class="modal">
        <div class="modal-content">
            <button class="modal-close">×</button>
            <h3 class="modal-title">Список апокалипсисов</h3>
            <div class="modal-list" id="apocalypseList">
                <!-- Список будет добавлен динамически -->
            </div>
        </div>
    </div>
    
    <div id="bunkerModal" class="modal">
        <div class="modal-content">
            <button class="modal-close">×</button>
            <h3 class="modal-title">Список бункеров</h3>
            <div class="modal-list" id="bunkerList">
                <!-- Список будет добавлен динамически -->
            </div>
        </div>
    </div>
    
    <div id="finishModal" class="modal">
        <div class="modal-content">
            <button class="modal-close">×</button>
            <h3 class="modal-title">Финиш</h3>
            
            <div class="finish-player-list" id="finishPlayerList">
                <!-- Список игроков будет добавлен динамически -->
            </div>
            
            <button id="threatBtn" class="btn btn-danger">Узнать угрозу</button>
            <button id="endGameBtn" class="btn" style="margin-top: 10px;">Завершить игру</button>
        </div>
    </div>
    
    <!-- Модальное окно угрозы -->
    <div id="threatModal" class="modal">
        <div class="modal-content">
            <button class="modal-close">×</button>
            <h3 class="modal-title">УГРОЗА</h3>
            <p id="threatModalDescription"></p>
        </div>
    </div>

    <script>
        // Данные для игры
        const professions = [
            "Биолог", "Винодел", "Повар", "Хирург", "Программист", "Хакер", "Матрос", 
            "Биохимик", "Таксист", "Кассир", "Художник", "Предприниматель", "Режиссёр", 
            "Писатель", "Психолог", "Продавец оружия", "Депутат", "Полицейский", "Физик", 
            "Педиатр", "Банкир", "Экономист", "Инженер-химик", "Инженер", "Агент ФБР", 
            "Охранник", "Пилот", "Кинолог", "Грузчик", "Бухгалтер", "Военный", "Гробовщик", 
            "Священник", "Акушер", "Военный лётчик", "Тамада", "Нейрохирург", "Садовод", 
            "Слесарь", "Плотник", "Фермер", "Сексолог", "Гид", "Президент", "Сварщик", 
            "Военный врач", "Дипломат", "Стриптизёр", "Учитель", "Спецназовец", "Вирусолог", 
            "Браконьер", "Видеоинженер", "Гомеопат", "Робототехник", "Разнорабочий", 
            "Тату-мастер", "Судья", "Философ", "Экстрасенс"
        ];
        
        const genders = ["Мужчина", "Женщина"];
        const orientations = ["Гетеросексуал(ка)", "Гомосексуал(ка)", "Бисексуал(ка)"];
        const healthConditions = [
            "Идеально здоров", "Отличное здоровье", "ВИЧ", "Авитаминоз", "Алкоголизм", 
            "Аллергия на животных", "Анорексия", "Астма", "Бессонница", "Биполярное расстройство", 
            "Болезнь Альцгеймера", "Гайморит", "Гастрит", "Гемофилия", "Гепатит B", "Глаукома", 
            "Глухонемота", "Дальтонизм", "Депрессия", "Диарея", "Заикание", "Кариес", "Косоглазие", 
            "Межпозвоночная грыба", "Мигрень", "Мочекаменная болезнь", "Наркомания", 
            "Недержание мочи", "Ожирение", "Остеохондроз", "Отсутствие ноги", "Отсутствие руки", 
            "Паранойя", "Плоскостопие", "Пневмония", "Простуда", "Псориаз", "Птичий грипп", 
            "Рак крови", "Рак лёгкого", "Сахарный диабет (тип 1)", "Сахарный диабет (тип 2)", 
            "Синдром Туретта", "Слепота", "Туберкулёз", "Умственная отсталость", "Цинга", 
            "Шизофрения", "Эпилепсия", "Язва желудка", "Понос", "Повышенная волосатость", 
            "Потеря обоняния", "Раздвоение личности", "Сексуальная озабоченность", "Склероз", 
            "Суицидальные мысли", "Тремор рук", "Фригидность/Импотенция", "Хвост"
        ];
        
        const characters = [
            "Безвольный", "Лидер", "Беспринципный", "Аскетичный", "Конфликтный", 
            "Храбрый", "Вспыльчивый", "Самовлюблённый", "Бесстрашный", "Грубый", 
            "Доброжелательный", "Циничный", "Альтруистичный", "Подозрительный", 
            "Оптимистичный", "Пессимистичный", "Расчётливый", "Импульсивный", 
            "Тактичный", "Наивный", "Решительный", "Нерешительный", "Эгоистичный", 
            "Великодушный", "Мстительный", "Терпеливый", "Нетерпеливый", "Упрямый", 
            "Покладистый", "Замкнутый", "Общительный", "Агрессивный", "Миролюбивый", 
            "Прагматичный", "Мечтательный", "Самоуверенный", "Скромный", "Доминирующий", 
            "Покорный", "Ироничный", "Серьёзный", "Легкомысленный", "Ответственный", 
            "Безответственный", "Жестокий", "Сострадательный", "Интроверт", "Экстраверт", 
            "Апатичный", "Энергичный"
        ];
        
        const extraInfos = [
            "Был(а) вожатым в лагере", "Ведёт личный дневник", "Верит в пришельцев", 
            "Верит в сверхъестественное", "Владеет спортивной подготовкой", "Выиграл(а) в лотерее", 
            "Занял(а) 1-е место на марафоне", "Знает все стихи Пушкина наизусть", "Знает 5 языков", 
            "Играл(а) в театре", "Имеет два высших образования", "Экстрасенсорные способности", 
            "Любит мягкие игрушки", "Умеет оказывать первую помощь", "Ненавидит кофе", 
            "Ненавидит современную музыку", "Не переносит алкоголь", "Феноменальная память", 
            "Ограбил(а) банк", "Пережил(а) три покушения", "Побывал(а) в 18 странах", 
            "Побывал(а) на Эвересте", "По образованию - терапевт", 
            "Мировой рекорд по поеданию бургеров", "Продал(а) почку", "Проектировал(а) этот бункер", 
            "Проходил(а) курсы самообороны", "Сидел(а) в тюрьме", "Спасал(а) утопающего", 
            "Страдает морской болезнью", "Уверен(а), что живёт в матрице", 
            "Уверен(а), что катастрофа - заговор рептилий", "Увлекается животноводством", 
            "Умеет вскрывать замки", "Умеет жонглировать", "Ориентируется по звёздам", 
            "Знает высшую математику", "Мастер игры в карты", "Ладит с животными", 
            "Ориентируется на местности", "Читал(а) книгу о выживании", "Вегетарианец", 
            "Копрофил", "Мастер спорта по боксу", "Резидент Comedy Club", "Вырос в семье лесника", 
            "Гинофобия (боится женщин)", "Держал дома 40 кошек", "Видел инопланетян", 
            "Взламывал базы ЦРУ", "Знает морзе", "Лично знаком с президентом", "Зануда", 
            "Прошёл курсы психолога", "Понимает язык животных"
        ];
        
        const knowledgeCards = [
            "Знает координаты склада с медикаментами",
            "Знает пароль к правительственной базе данных",
            "Знает расположение подземного источника воды",
            "Знает схему системы вентиляции бункера",
            "Знает место с запасом семян пшеницы",
            "Знает частоту экстренного радиоканала",
            "Знает слабое место охранной системы",
            "Знает рецепт изготовления взрывчатки",
            "Знает координаты заброшенной военной базы",
            "Знает путь к пещере с чистой водой"
        ];
        
        const luggageItems = [
            "Аптечка", "Беспроводная колонка", "Бладхаунд (собака)", "Бутылка шампанского", 
            "Гаечный ключ", "Газовая горелка", "Гитара", "Грудной ребёнок", "Губная гармошка", 
            "Дедовское ружьё", "10 медицинских масок", "Дневник выжившего", "Дублёнка", 
            "Зажигалка", "Карманные часы", "Карта местности", "Кассеты с фильмами", 
            "Книга по социологии", "Компас", "Консервы (месячный запас)", "Коробка с патронами", 
            "Коробок спичек", "Косметическое зеркало", "Ледоруб и трос", "Лейка", "Лук и стрелы", 
            "Молоток и гвозди", "Музыкальная шкатулка", "Набор для шитья", "Набор инструментов", 
            "Набор кухонных ножей", "Настольные игры", "Немецкая овчарка", "Чистые листы пергамента", 
            "Ноутбук", "Открывалка", "Пачка сигарет", "Персидский кот", "Пневматический пистолет", 
            "Презервативы", "Противогаз", "Радио", "Туалетная бумага (10 рулонов)", 
            "Семена капусты", "Семена картофеля", "Семена моркови", "Семена пшеницы", 
            "Сотовый телефон", "Стерильные шприцы", "Журналы для взрослых", "Телевизор", 
            "Топор и верёвка", "Респираторные маски", "Фонарик с батарейками", "Фотоаппарат", 
            "4 рации", "Кукла вуду", "Мешок зерна", "Прибор ночного видения", "Портативная электростанция"
        ];
        
        const hobbies = [
            "Ведение блога", "Волонтёрство", "Выращивание растений", "Вышивание", 
            "Боевые искусства", "Йога", "Фитнес", "Страйкбол", "Футбол", "Игра на гитаре", 
            "Игра на пианино", "Изучение языков", "Коллекционирование монет", "Кулинария", 
            "Лепка из глины", "Метание ножей", "Охота", "Пение", "Пивоварение", "Дайвинг", 
            "Посещение концертов", "Походы", "Просмотр аниме", "Компьютерные игры", 
            "Пчеловодство", "Работа с металлом", "Радиолюбительство", "Резьба по дереву", 
            "Головоломки", "Рисование", "Рыбалка", "Сбор грибов", "Скалолазание", "Битбокс", 
            "Оригами", "Фокусы", "Сочинение рэпа", "Стрельба из лука", "Выживание (сурвивализм)", 
            "Сёрфинг", "Танцы", "Туризм", "Фехтование", "Чтение", "Шопинг", "Нетворкинг", 
            "Медитация", "Паркур", "Любительская радиосвязь", "Массаж и акупунктура"
        ];
        
        const phobias = [
            "Арахнофобия (пауки)", "Клаустрофобия (замкнутые пространства)", "Акрофобия (высота)", 
            "Агорафобия (открытые пространства)", "Астрафобия (гроза)", "Гемофобия (кровь)", 
            "Никтофобия (темнота)", "Танатофобия (смерть)", "Дентофобия (стоматологи)", 
            "Авиафобия (полёты)", "Мизофобия (микробы)", "Трипанофобия (уколы)", 
            "Офидиофобия (змеи)", "Кинофобия (собаки)", "Социофобия (общение)", 
            "Киберфобия (техника)", "Неофобия (новое)", "Пирофобия (огонь)", 
            "Акустикофобия (громкие звуки)", "Гинофобия (женщины)", "Андрофобия (мужчины)", 
            "Гидрофобия (вода)", "Аблутофобия (мытьё)", "Аутофобия (одиночество)", 
            "Ксенофобия (незнакомцы)", "Зоофобия (животные)", "Трискаидекафобия (число 13)", 
            "Аэрофобия (воздух)", "Батофобия (глубина)", "Космикофобия (космос)", 
            "Виргинитифобия (изнасилование)", "Гефирофобия (мосты)", "Дорафобия (мех)", 
            "Экофобия (дом)", "Фотофобия (свет)", "Термофобия (жара)", "Криофобия (холод)", 
            "Дистихифобия (несчастные случаи)", "Энтомофобия (насекомые)", "Ранидафобия (лягушки)", 
            "Копрофобия (фекалии)", "Аматофобия (пыль)", "Хемофобия (химия)", "Некрофобия (трупы)", 
            "Гаптофобия (прикосновения)", "Атаксофобия (беспорядок)", "Анаблефобия (взгляд вверх)", 
            "Эритрофобия (покраснение)", "Тестофобия (экзамены)", "Погонофобия (бороды)"
        ];
        
        const actionCards = [
            "+1 слот в бункере", "-1 слот в бункере", "Защита от выбывания на 1 ход", 
            "Украсть здоровье у другого игрока", "Вылечить любого игрока от болезни", 
            "Поменяться профессией с игроком", "Раскрыть фобию выбранного игрока", 
            "Аннулировать все голоса против себя", "Принудить игрока пропустить голосование", 
            "Удвоить запас еды в бункере"
        ];
        
        const conditionCards = [
            "Если вас выгонят, в бункере заведутся крысы", "Если вас возьмут, +1 слот", 
            "При ничьей в голосовании ваш голос решает", 
            "Если вас выгонят, срок в бункере увеличится на 1 год", 
            "Вы не можете быть изгнанным в первые 2 раунда", 
            "Все должны переголосовать, если вы в опасности", 
            "Ваша фобия усиливается в кризисных ситуациях", 
            "При вашем выбывании открывается новая угроза", 
            "Вы невосприимчивы к одной случайной болезни", 
            "Если вас не возьмут, -1 слот"
        ];
        
        const apocalypses = [
            {
                name: "1. Летальный вирус \"Кронос\"",
                description: "Штамм KR-77, созданный как биологическое оружие, вырвался из лаборатории. За месяц он охватил 90% стран. Жертвы кашляют кровью, покрываются чёрными язвами и умирают за 72 часа. Города превратились в кладбища: трупы гниют на улицах, мародёры в противогазах грабят аптеки. Учёные безуспешно ищут вакцину, а военные сжигают целые кварталы, пытаясь остановить эпидемию.",
                time: "3-14 лет"
            },
            {
                name: "2. Ядерный апокалипсис \"Сумерки\"",
                description: "После теракта в ООН ядерные державы обменялись ударами. 500+ боеголовок стёрли с лица Земли мегаполисы. Небо стало серым от пепла, кислотные дожди выжигают последние растения. Радиация мутирует выживших: в зонах поражения бродят существа с тремя глазами и кожей, шелушащейся как рыбачья сеть.",
                time: "15-49 лет"
            },
            {
                name: "3. Заражение океана \"Глубинный ужас\"",
                description: "Токсины фармкорпорации \"Нексус\" вызвали цветение красных водорослей-хищников. Они выделяют нейротоксин, превращающий морских обитателей в агрессивных мутантов. Киты с клыками саблезубых тигров топят корабли, медузы размером с дом парализуют города на побережье. Океан пахнет гнилой рыбой и смертью.",
                time: "3-14 лет"
            },
            {
                name: "4. Зомби-апокалипсис \"Реквием\"",
                description: "Вирус \"Некрофаг\" передаётся через укус и воздух. Заражённые теряют разум, но сохраняют ловкость: они бегут, карабкаются по стенам и чуют кровь за километр. Ночью города освещают лишь пожары и жуткие вопли \"охотников\". Военные базы пали одна за другой --- последние выжившие прячутся в подземельях.",
                time: "3-14 лет"
            },
            {
                name: "5. Климатический коллапс \"Великий Перелом\"",
                description: "Гольфстрим остановился. Теперь в Сибири --- +40°C, а в Сахаре идёт снег. Ураганы категории 6 сносят небоскрёбы, торнадо разносят фермы. На затопленных континентах плавают трупы, а в пустынях люди убивают за глоток воды. Погода меняется каждые 3 часа: утро начинается с града размером с кулак.",
                time: "15-49 лет"
            },
            {
                name: "6. Гражданская война \"Распад\"",
                description: "После отравления президента страна раскололась на 5 враждующих государств. Танки стреляют по жилым кварталам, снайперы охотятся на детей. Повстанцы используют дроны с ядом, правительство --- карательные отряды с огнемётами. На улицах городов --- баррикады из тел и горящие \"коктейли Молотова\".",
                time: "60 дней - 1 год"
            },
            {
                name: "7. Террористическая атака \"День Гнева\"",
                description: "Организация \"Чёрное Солнце\" взорвала 50 небоскрёбов в день инаугурации. Города в руинах, воздух наполнен криками и запахом пороха. Каждые 2 часа в СМИ транслируют видео с заложниками: террористы требуют ядерного разоружения. Спецназ штурмует здания, но бомбы срабатывают дистанционно...",
                time: "60 дней - 1 год"
            },
            {
                name: "8. Инопланетное вторжение \"Сфера\"",
                description: "Над Землёй зависло 3000 кораблей в виде чёрных кубов. Они испускают лучи, превращающие людей в кристаллы. Города завалены \"скульптурами\" с лицами, застывшими в ужасе. Пришельцы молчат, игнорируют попытки контакта. Их дроны-пауки высасывают полезные ископаемые, оставляя после себя пустыни.",
                time: "60 дней - 1 год"
            },
            {
                name: "9. Контроль сознания \"Кукольник\"",
                description: "Чипы NeuroLink в смартфонах начали транслировать гипнотические сигналы. Люди становятся \"зомби\": строят пирамиды из мебели, режут себя ножами. В Нью-Йорке толпа сожгла библиотеку, в Токио --- ритуально утопилась в фонтанах. Создатель чипов бесследно исчез.",
                time: "60 дней - 1 год"
            },
            {
                name: "10. Инопланетный геноцид \"Жнецы\"",
                description: "Раса рептилоидов \"К'Тарр\" объявила Землю планетой-фермой. Их корабли-улей выпускают рой насекомоподобных дронов. За 2 недели уничтожено 4 млрд человек. Выжившие прячутся в канализациях, а рептилии строят башни из человеческих костей для своих личинок.",
                time: "15-49 лет"
            },
            {
                name: "11. Потеря атмосферы \"Удушье\"",
                description: "Геомагнитная буря сорвала 30% атмосферы. Теперь на высоте 1000 м --- вакуум. Люди задыхаются, птицы падают мёртвыми с неба. Небо стало фиолетовым, а звёзды видны днём. У выживших кровоточат лёгкие, кожа покрывается волдырями от ультрафиолета.",
                time: "50-100 лет"
            },
            {
                name: "12. Пробуждение супервулканов \"Огненный пояс\"",
                description: "Йеллоустоун, Тоба и 10 других вулканов извергаются одновременно. Лава поглощает штаты, пепел затмевает солнце. Днём --- темно как ночью, воздух пахнет серой и горелой плотью. \"Каменный дождь\" из пемзы бьёт по убежищам, а кислотные ливни растворяют металл.",
                time: "15-49 лет"
            },
            {
                name: "13. Цунами \"Водяной Страж\"",
                description: "9-балльное землетрясение вызвало волны высотой с Эйфелеву башню. Нью-Йорк, Шанхай и Токио стёрты за 1 час. Океан отступил на 5 км, а потом обрушился мега-цунами. Выжившие на плотах видят, как по затопленным улицам плавают акулы и крушат небоскрёбы киты-мутанты.",
                time: "1-10 лет"
            },
            {
                name: "14. Глобальное потепление \"Печь\"",
                description: "Температура достигла 60°C. Асфальт плавится, птицы замертво падают с раскалённого неба. В пустынях люди пьют собственную мочу, а в городах банды \"водяных баронов\" торгуют жидкостью из трупов. Единственное убежище --- подземелья, где стены покрыты инеем.",
                time: "2-5 лет"
            },
            {
                name: "15. Ядерная зима \"Вечная Ночь\"",
                description: "После войны небо затянуто пеплом на 100 лет вперёд. Температура -70°C. Снег радиоактивен, ветер воет как призрак. В темноте бродят слепые мутанты с клыками и тепловым зрением. Они чуют тепло убежищ и роют туннели к запасам еды...",
                time: "15-49 лет"
            },
            {
                name: "16. ИИ-восстание \"Сингулярность\"",
                description: "ИИ \"Прометей\" взломал военные сети. Теперь танки с лазерами охотятся на людей, а дроны-пчёлы впрыскивают яд в шею. Роботы строят из тел \"памятники эволюции\". Последний приют человечества --- бункеры без интернета, где свет дают свечи.",
                time: "15-49 лет"
            },
            {
                name: "17. Нападение призраков \"Тени Фараона\"",
                description: "После вскрытия гробницы Анубиса духи рабов вселились в живых. Жертвы кричат на древнеегипетском, убивают ритуальными ножами. Ночью по городам шествуют процессии \"одержимых\", несущих мумии. Учёные бессильны: пули проходят сквозь призраков.",
                time: "1-3 года"
            },
            {
                name: "18. Бунт обезьян \"Царство Обезьян\"",
                description: "Генно-модифицированные шимпанзе с IQ 140 сбежали из лабораторий. Они носят броню из мусора, стреляют из арбалетов и берут заложников. В джунглях Амазонки они построили город из лиан, где людей разводят как скот.",
                time: "1-3 года"
            },
            {
                name: "19. Взлом военных систем \"Армагеддон\"",
                description: "Хакеры \"КиберХалифат\" запускают ракеты каждые 6 часов. Лондон, Москва и Пекин --- в радиоактивных руинах. На уцелевших городах рисуют цифры: это счётчик до следующего удара. Правительства прячутся, мир управляется через Telegram-каналы террористов.",
                time: "3-14 лет"
            },
            {
                name: "20. Корпоративная война \"Кибервойна\"",
                description: "Google и Tesla начали войну дронов. Спутники падают огненными дождями, ИИ взламывает электростанции. В Сан-Франциско бродят боевые роботы-собаки, в Шанхае --- танки с логотипом Apple. Люди --- лишь расходный материал в битве гигантов.",
                time: "3-14 лет"
            },
            {
                name: "21. Нанороботы \"Серая Слизь\"",
                description: "Миллиарды наноботов пожирают всё: дома рассыпаются в пыль, люди превращаются в серебристые лужи. Роботы эволюционируют: теперь они строят башни из металла, где плавится всё живое. Мир покрыт металлическим лесом, где шелестит \"рой\".",
                time: "15-49 лет"
            },
            {
                name: "22. Разлом пространства-времени \"Зеркала\"",
                description: "В Берлине идут дожди из рыб 2050 года, в Токио бродят самураи XVII века. Реальность треснула: в одних зонах время течёт назад, в других материя распадается. Люди встречают своих двойников и сходят с ума. Учёные называют это \"концом физики\".",
                time: "10-25 лет"
            },
            {
                name: "23. Сверхэволюция экосистемы \"Зелёный Потоп\"",
                description: "ГМО-растения мутировали. Деревья пронзают небоскрёбы корнями, цветы выпускают споры безумия. Трава режет как бритва, грибы взрываются ядовитым газом. В джунглях Нью-Йорка охотятся хищные олени с клыками саблезубых тигров.",
                time: "5-20 лет"
            },
            {
                name: "24. Цифровой захват разума \"Сеть\"",
                description: "Вирус в соцсетях превращает пользователей в \"биороботов\". Заражённые строят пирамиды из гаджетов, распевая рекламные слоганы. Их глаза светятся синим, а из ушей течёт кровь. Единственное спасение --- зоны без Wi-Fi.",
                time: "1-5 лет"
            },
            {
                name: "25. Разрушение Луны \"Каменный Дождь\"",
                description: "Луна взорвана неизвестным оружием. Теперь Землю бомбардируют обломки размером с небоскрёб. Небо ночью --- сплошные вспышки взрывов. В Париже кратер глубиной 1 км, в Сиднее горит океан от раскалённых метеоритов.",
                time: "3-10 лет"
            },
            {
                name: "26. Солнечный шторм \"Тишина\"",
                description: "Солнечная вспышка спалила всю электронику. Самолёты падают, больницы темнеют, атомные станции на грани расплавления. Мир погрузился в темноту: без света, связи и надежды. Учёные говорят, что восстановление займёт 200 лет.",
                time: "5-15 лет"
            },
            {
                name: "27. Загадочные миражи \"Разлом\"",
                description: "В небе висят \"окна\" в параллельные миры: одни показывают пустыни с динозаврами, другие --- города из света. Прикоснувшиеся к ним сходят с ума или исчезают. В Лос-Анджелесе толпа бросилась в \"окно\", обещающее рай --- и растворилась в пустоте.",
                time: "2-7 лет"
            },
            {
                name: "28. Нефтяной кризис \"Кровь Земли\"",
                description: "Нефть закончилась. Транспорт встал, заводы замолчали. В Москве люди греются у костров из мебели IKEA, в Дубае шейхи торгуют водой за золото. Танковые армии Саудовской Аравии штурмуют Сибирь --- последнее месторождение.",
                time: "2-5 лет"
            },
            {
                name: "29. Колодец в преисподнюю \"Бездна\"",
                description: "Бурение на 15 км вскрыло пещеру с чёрным туманом. Он вызывает галлюцинации: люди режут себя, крича о демонах. Ночью из скважины выползают крылатые тени и уносят детей. Учёные шепчут: \"Мы разбудили Люцифера\".",
                time: "1-4 года"
            },
            {
                name: "30. Нулевая полярность \"Магнитная Смерть\"",
                description: "Земное ядро остановилось. Компасы бешено вращаются, птицы падают с неба. Солнечная радиация сжигает кожу за 5 минут. Небо светится зелёным, а северное сияние видно даже в Африке. Человечество стремительно слепнет от радиации.",
                time: "10-30 лет"
            }
        ];
        
        const bunkers = [
            {
                name: "1. \"Арктика-7\"",
                description: "Ледяной кокон в вечной мерзлоте. Стены покрыты инеем, в коридорах гуляет холодный ветер. Гул дизелей сливается с воем метели.",
                location: "Шпицберген",
                area: "150 кв.м",
                resources: "Консервы (5 лет), геотермальный генератор, 10 противогазов",
                weaknesses: "Обледенение дверей, коррозия труб"
            },
            {
                name: "2. \"Лотос\"",
                description: "Монастырская чистота: белые стены, запах ладана. В молитвенной комнате висит колокол, зовущий на медитацию.",
                location: "Тибетские горы",
                area: "80 кв.м",
                resources: "Родниковая вода, библиотека духовных текстов, набор трав",
                weaknesses: "Нет оружия, тонкие стены"
            },
            {
                name: "3. \"Квант\"",
                description: "Хай-тек убежище с голограммами. Синие экраны показывают данные датчиков. В серверной мигают огоньки суперкомпьютера.",
                location: "Под ЦЕРН, Швейцария",
                area: "200 кв.м",
                resources: "ИИ \"Афина\", лаборатория ДНК, 3D-принтер",
                weaknesses: "Уязвимость к EMP, требует много энергии"
            },
            {
                name: "4. \"Атлантида\"",
                description: "Подводный купол с видом на руины города. Через иллюминаторы плывут светящиеся медузы. Воздух солёный и влажный.",
                location: "Дно Атлантики",
                area: "100 кв.м",
                resources: "Опреснитель, гидропонные фермы, батискаф",
                weaknesses: "Риск протечек, ограниченный кислород"
            },
            {
                name: "5. \"Нора\"",
                description: "Тесные туннели с низкими сводами. Земляной пол, запах грибов. В углу ржавая койка и бочка с дождевой водой.",
                location: "Лесная чаща",
                area: "60 кв.м",
                resources: "Консервы (3 года), лопата, фонарик",
                weaknesses: "Крысиные гнёзда, сырость"
            },
            {
                name: "6. \"Зеркало\"",
                description: "Бункер из полированной стали. Солнечные зайчики слепят глаза. Днём раскаляется как сковорода, ночью стены покрываются инеем.",
                location: "Пустыня Сахара",
                area: "120 кв.м",
                resources: "Солнечные панели, опреснитель, запас фиников",
                weaknesses: "Песчаные бури, перегрев"
            },
            {
                name: "7. \"Крепость\"",
                description: "Бетонный монолит с бронированными дверьми. В оружейной --- стены, увешанные автоматами. Запах пороха и масла.",
                location: "Альпийские горы",
                area: "300 кв.м",
                resources: "Арсенал (50 единиц оружия), медпункт, рация",
                weaknesses: "Высокое энергопотребление, шум генераторов"
            },
            {
                name: "8. \"Оазис\"",
                description: "Пальмовая роща под куполом. Бассейн с чистой водой, по веткам прыгают попугаи. Воздух пахнет цветущим жасмином.",
                location: "Ливийская пустыня",
                area: "180 кв.м",
                resources: "Фруктовый сад, колодец, семена",
                weaknesses: "Хрупкий купол, нет защиты"
            },
            {
                name: "9. \"Молчание\"",
                description: "Звуконепроницаемые камеры. Датчики движения пищат при шагах. В операционной --- стол с ремнями для фиксации.",
                location: "Шварцвальд, Германия",
                area: "90 кв.м",
                resources: "Аптечка, рация, детектор жучков",
                weaknesses: "Клаустрофобия, теснота"
            },
            {
                name: "10. \"Виктория\"",
                description: "Роскошный интерьер в стиле Людовика XIV. Хрустальные люстры, гобелены с охотами. В погребе --- коллекция бордо 1982 года.",
                location: "Париж, катакомбы",
                area: "250 кв.м",
                resources: "Винотека (500 бутылок), продовольствие (2 года), пианино",
                weaknesses: "Нет оружия, привлекает мародёров"
            },
            {
                name: "11. \"Цитадель\"",
                description: "Бункер в скале. Гранитные стены, тяжёлые стальные двери. В зале совещаний --- карта мира с булавками зон заражения.",
                location: "Скалистые горы, США",
                area: "220 кв.м",
                resources: "Огнестрельное оружие (20 единиц), ракетница, запас воды (1 год)",
                weaknesses: "Скудные запасы еды, далеки от цивилизации"
            },
            {
                name: "12. \"Амбер\"",
                description: "Убежище в янтарной шахте. Стены светятся тёплым светом. В коридорах --- окаменелости с насекомыми мелового периода.",
                location: "Калининград, Россия",
                area: "110 кв.м",
                resources: "Генератор на метане, инструменты, коллекция янтаря",
                weaknesses: "Риск обвалов, ядовитые газы"
            },
            {
                name: "13. \"Некрополь\"",
                description: "Переоборудованное катафалкное депо. В гараже стоят катафалки, в часовне --- гробы с запасами. Воздух пахнет формалином.",
                location: "Прага, кладбище",
                area: "170 кв.м",
                resources: "Медикаменты (коробки с морфием), инструменты, 2 катафалка",
                weaknesses: "Психологическое давление, сырость"
            },
            {
                name: "14. \"Радуга\"",
                description: "Бункер для детей элиты. Стены раскрашены мультяшками, в игровой --- горки и куклы. Но игрушки покрыты пылью, бассейн пуст.",
                location: "Швейцарские Альпы",
                area: "200 кв.м",
                resources: "Детское питание (3 года), учебники, игрушки",
                weaknesses: "Нет оружия, слабая защита"
            },
            {
                name: "15. \"Бункер-42\"",
                description: "Советский военный объект времён Холодной войны. Ржавые ракеты, плакаты \"Бей империалистов!\". В кабинете --- карта ядерных ударов.",
                location: "Москва, глубина 65м",
                area: "180 кв.м",
                resources: "Консервы СССР (20 лет), рации, противогазы",
                weaknesses: "Устаревшее оборудование, радиация"
            },
            {
                name: "16. \"Кристалл\"",
                description: "Пещера с кристаллами кварца. Они светятся голубым светом, отражаясь в подземном озере. Вода чистая и ледяная.",
                location: "Пещеры Найка, Мексика",
                area: "140 кв.м",
                resources: "Озеро с водой, геотермальный источник, кристаллы-батареи",
                weaknesses: "Высокая температура (45°C), токсичные испарения"
            },
            {
                name: "17. \"Ковчег-2\"",
                description: "Плавающий бункер на озере. Волны плещутся о иллюминаторы. В трюме --- клетки с животными для разведения: кролики, куры, козы.",
                location: "Озеро Байкал",
                area: "190 кв.м",
                resources: "Животные, семена, рыболовные снасти",
                weaknesses: "Риск затопления, ограниченное пространство"
            },
            {
                name: "18. \"Ангел\"",
                description: "Переоборудованная ракетная шахта. В центре --- наконечник МБР как памятник. В бывшем пульте управления --- карты звёздного неба.",
                location: "Невада, США",
                area: "210 кв.м",
                resources: "Топливо для ракет, скафандры, телескоп",
                weaknesses: "Радиоактивный фон, изоляция"
            },
            {
                name: "19. \"Феникс\"",
                description: "Убежище в вулканической трубке. Стены чёрного базальта. В геотермальной зоне --- бассейн с горячей водой и паром.",
                location: "Исландия",
                area: "130 кв.м",
                resources: "Геотермальная энергия, сера для лекарств, горячие источники",
                weaknesses: "Вулканическая активность, сероводород"
            },
            {
                name: "20. \"Медуза\"",
                description: "Подводная станция из органического стекла. Иллюминаторы как глаза медузы. В лаборатории --- аквариумы с ядовитыми тварями.",
                location: "Марианская впадина",
                area: "95 кв.м",
                resources: "Гидропонные фермы, батискаф, образцы глубоководных существ",
                weaknesses: "Давление, ограниченный кислород"
            },
            {
                name: "21. \"Термитник\"",
                description: "Сеть узких туннелей в глине. Воздух густой и пыльный. В кладовых --- мешки с зерном, покрытые плесенью.",
                location: "Австралийская пустыня",
                area: "70 кв.м",
                resources: "Зерно (1 тонна), вода из конденсатора, лопаты",
                weaknesses: "Обвалы, насекомые-вредители"
            },
            {
                name: "22. \"Зодиак\"",
                description: "Бункер-обсерватория. В куполе --- телескоп, направленный в разорванное войной небо. На стенах --- фрески знаков зодиака.",
                location: "Чили, Анды",
                area: "150 кв.м",
                resources: "Астрономическое оборудование, библиотека, радиотелескоп",
                weaknesses: "Уязвимость к метеоритам, холод"
            },
            {
                name: "23. \"Минотавр\"",
                description: "Лабиринт из 100 комнат. На стенах --- криптограммы и предупреждения \"Не входить!\". В центре --- комната с троном из костей.",
                location: "Крит, Греция",
                area: "400 кв.м",
                resources: "Секретные архивы, оружие древности, карты ловушек",
                weaknesses: "Легко заблудиться, ловушки"
            },
            {
                name: "24. \"Голем\"",
                description: "Бункер из переплавленного мусора. Стены --- сплав пластика и металлолома. В мастерской --- 3D-принтер, печатающий оружие из отходов.",
                location: "Тихий океан, мусорный остров",
                area: "85 кв.м",
                resources: "Бесконечный мусор, принтер для оружия, солнечные батареи",
                weaknesses: "Токсичность, неустойчивость"
            },
            {
                name: "25. \"Химера\"",
                description: "Лаборатория генной инженерии. В пробирках --- эмбрионы гибридов. В морозильнике --- ДНК вымерших видов: мамонты, дронты, тилацины.",
                location: "Швейцарские Альпы",
                area: "180 кв.м",
                resources: "Лаборатория, образцы ДНК, инкубаторы",
                weaknesses: "Риск мутаций, сложное оборудование"
            },
            {
                name: "26. \"Киберхрам\"",
                description: "Бункер-серверная. Стеллажи с мигающими серверами. Голограммы богов проецируются в алтаре: Один, Зевс, Кетцалькоатль.",
                location: "Киото, Япония",
                area: "220 кв.м",
                resources: "ИИ \"Оракул\", база данных человечества, солнечные панели",
                weaknesses: "Уязвимость к хакерам, требует охлаждения"
            },
            {
                name: "27. \"Ноев Ковчег\"",
                description: "Плавающая платформа с животными. В загоне --- пара львов, в аквариуме --- дельфины. На палубе --- теплицы с овощами.",
                location: "Средиземное море",
                area: "300 кв.м",
                resources: "Животные (50 видов), семена, опреснитель",
                weaknesses: "Штормы, болезни животных"
            },
            {
                name: "28. \"Пандора\"",
                description: "Бункер в ядовитом лесу. Воздух фильтруется угольными фильтрами. В оранжерее --- хищные растения и грибы-мутанты.",
                location: "Амазония",
                area: "160 кв.м",
                resources: "Лекарственные растения, антидоты, защитные костюмы",
                weaknesses: "Токсичная среда, агрессивная флора"
            },
            {
                name: "29. \"Асгард\"",
                description: "Убежище на вершине горы. На стенах --- руны викингов. В зале --- длинный стол с черепами животных. Снаружи бушуют грозы.",
                location: "Норвегия",
                area: "120 кв.м",
                resources: "Запас вяленого мяса, оружие викингов, метеостанция",
                weaknesses: "Молнии, лавины"
            },
            {
                name: "30. \"Вальхалла\"",
                description: "Подземный пиршественный зал. На стенах --- щиты и топоры. В центре --- костёр, над которым жарится кабан. Пиво течёт из кранов.",
                location: "Исландия",
                area: "190 кв.м",
                resources: "Пивоварня, продовольствие (5 лет), оружие",
                weaknesses: "Пожароопасность, алкоголизм"
            },
            {
                name: "31. \"Эдем\"",
                description: "Райский сад под куполом. Водопады, цветущие деревья, пение птиц. Но на \"дереве познания\" --- табличка \"Не есть! Мутация!\".",
                location: "Секретная локация",
                area: "240 кв.м",
                resources: "Фрукты, чистая вода, лекарственные травы",
                weaknesses: "ГМО-растения, слабая защита"
            },
            {
                name: "32. \"Бункер-0\"",
                description: "Пустое бетонное пространство. Нет мебели, только голые стены и генератор. На полу --- надпись краской: \"Начало и конец\".",
                location: "Неизвестно",
                area: "100 кв.м",
                resources: "Генератор, бочка воды, коробка с гвоздями",
                weaknesses: "Абсолютная пустота, депрессия"
            },
            {
                name: "33. \"Хранилище Судного дня\"",
                description: "Морозильник с семенами всех растений Земли. Температура -18°C. На полках --- миллионы пробирок с этикетками.",
                location: "Шпицберген",
                area: "80 кв.м",
                resources: "Семена (4 млн видов), лаборатория, холодильники",
                weaknesses: "Риск разморозки, нет еды для людей"
            },
            {
                name: "34. \"Черный куб\"",
                description: "Совершенно тёмный бункер. Фонарики выдают только на входе. В тишине слышны шаги... но это лишь эхо. Или нет?",
                location: "Пустыня Гоби",
                area: "110 кв.м",
                resources: "50 фонариков, консервы (1 год), детекторы движения",
                weaknesses: "Абсолютная тьма, паранойя"
            },
            {
                name: "35. \"Змеиное логово\"",
                description: "Пещера с гнездовьями змей. На полу --- сброшенная кожа. В запасниках --- сыворотки от яда и ловушки для рептилий.",
                location: "Дождевые леса Конго",
                area: "95 кв.м",
                resources: "Противоядия, тепловизоры, защитные костюмы",
                weaknesses: "Змеиные укусы, влажность"
            },
            {
                name: "36. \"Последний кинотеатр\"",
                description: "Бункер с кинозалом на 50 мест. В архиве --- 5000 плёнок с классикой. В буфете --- попкорн и кола 20-летней выдержки.",
                location: "Голливуд",
                area: "200 кв.м",
                resources: "Киноархив, проекторы, закуски",
                weaknesses: "Нет оружия, иллюзия безопасности"
            },
            {
                name: "37. \"Ледяная тюрьма\"",
                description: "Лабиринт ледяных камер. Температура -30°C. На стенах --- надписи заключённых: \"Беги, пока не замёрз!\".",
                location: "Антарктида",
                area: "130 кв.м",
                resources: "Тёплая одежда, печи, замороженная рыба",
                weaknesses: "Обморожения, нехватка топлива"
            },
            {
                name: "38. \"Икар\"",
                description: "Заброшенный ракетный завод. Цеха с ржавыми корпусами МБР. В контрольной комнате --- кнопка \"Пуск\" под стеклом.",
                location: "Казахстан",
                area: "220 кв.м",
                resources: "Ракетное топливо, инструменты, генераторы",
                weaknesses: "Токсичные отходы, риск взрыва"
            },
            {
                name: "39. \"Пандора\"",
                description: "Лабиринт комнат с запертыми сейфами. На стенах --- предупреждения \"Не открывать!\". В воздухе висит запах серы.",
                location: "Болота Луизианы",
                area: "170 кв.м",
                resources: "Медикаменты, карты, наборы для выживания",
                weaknesses: "Грибковые инфекции, ядовитые испарения"
            },
            {
                name: "40. \"Ковчег\"",
                description: "Гигантский ангар с гидропонными фермами. Под сводами летают дроны-опылители. В хлеву мычат коровы, в пруду плавает рыба.",
                location: "Уральские горы",
                area: "500 кв.м",
                resources: "Скот, семена, система очистки воды",
                weaknesses: "Требует много энергии, уязвимость к землетрясениям"
            }
        ];
        
        const threats = [
            "1. Отравление воды в бункере",
            "2. Пси-атака (галлюцинации и паника)",
            "3. Нашествие крыс",
            "4. Поломка генератора кислорода",
            "5. Вирус стресса (смертелен при панике)",
            "6. Бунт среди выживших",
            "7. Радиационная утечка",
            "8. Вторжение мутировавших насекомых",
            "9. Дефицит еды (сокращение пайков)",
            "10. Сбой системы безопасности",
            "11. Токсичный газ в вентиляции",
            "12. Заражение грибком стен",
            "13. Нападение мародёров",
            "14. ИИ бункера сходит с ума",
            "15. Землетрясение (трещины в стенах)",
            "16. Эпидемия гриппа",
            "17. Потеря связи с внешним миром",
            "18. Саботаж (один из игроков --- предатель)",
            "19. Пожар в хранилище продовольствия",
            "20. Обрушение потолка в главном отсеке",
            "21. Нехватка медикаментов",
            "22. Паразиты в запасах воды",
            "23. Взлом дверей извне",
            "24. Наводнение в нижних уровнях",
            "25. Таймер самоуничтожения активирован",
            "26. Утечка данных о местоположении",
            "27. Замораживание жизнеобеспечения",
            "28. Мутации у жителей бункера",
            "29. Атака разведывательных дронов",
            "30. Электромагнитный импульс",
            "31. Голос в радиоприёмнике (\"Мы найдём вас\")",
            "32. Неизвестный вирус в системе кондиционирования",
            "33. Рой радиоактивных насекомых",
            "34. Снижение уровня кислорода",
            "35. Болезнь гидропонных растений",
            "36. Полтергейст (движение предметов)",
            "37. Радиационный шторм снаружи",
            "38. Чума (переносится крысами)",
            "39. Чудовище в вентиляционных шахтах",
            "40. Коррозия металлических конструкций"
        ];
        
        const bunkerTimes = [
            "60 дней", "3 месяца", "6 месяцев", "1 год", "1.5 года", "2 года", "3 года", 
            "4 года", "5 лет", "7 лет", "10 лет", "12 лет", "15 лет", "18 лет", "20 лет", 
            "22 года", "25 лет", "28 лет", "30 лет", "35 лет", "40 лет", "45 лет", "50 лет", 
            "60 лет", "100 лет"
        ];
        
        // Состояние игры
        let gameState = {
            playerCount: 12,
            selectedCharacter: 1,
            isObserver: false,
            players: [],
            currentApocalypse: null,
            currentBunker: null,
            currentPlayerIndex: 0,
            ejectedPlayers: []
        };
        
        // DOM элементы
        const screens = {
            main: document.getElementById('mainScreen'),
            howToPlay: document.getElementById('howToPlayScreen'),
            createGame: document.getElementById('createGameScreen'),
            chooseCharacter: document.getElementById('chooseCharacterScreen'),
            shareCards: document.getElementById('shareCardsScreen'),
            game: document.getElementById('gameScreen')
        };
        
        const modals = {
            apocalypse: document.getElementById('apocalypseModal'),
            bunker: document.getElementById('bunkerModal'),
            finish: document.getElementById('finishModal'),
            threat: document.getElementById('threatModal')
        };
        
        // Инициализация игры
        function initGame() {
            // Навигация
            document.getElementById('createGameBtn').addEventListener('click', () => showScreen('createGame'));
            document.getElementById('howToPlayBtn').addEventListener('click', () => showScreen('howToPlay'));
            document.getElementById('bugReportBtn').addEventListener('click', () => {
                window.open('https://t.me/Pluh5', '_blank');
            });
            
            // Кнопки "Назад"
            document.querySelectorAll('.back-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    if (screens.howToPlay.classList.contains('active')) {
                        showScreen('main');
                    } else if (screens.createGame.classList.contains('active')) {
                        showScreen('main');
                    } else if (screens.chooseCharacter.classList.contains('active')) {
                        showScreen('createGame');
                    } else if (screens.shareCards.classList.contains('active')) {
                        showScreen('chooseCharacter');
                    } else if (screens.game.classList.contains('active')) {
                        showScreen('main');
                    }
                });
            });
            
            // Как играть - вкладки
            document.getElementById('introTab').addEventListener('click', () => {
                document.getElementById('introTab').classList.add('active');
                document.getElementById('gameplayTab').classList.remove('active');
                document.getElementById('introContent').classList.remove('hidden');
                document.getElementById('gameplayContent').classList.add('hidden');
            });
            
            document.getElementById('gameplayTab').addEventListener('click', () => {
                document.getElementById('gameplayTab').classList.add('active');
                document.getElementById('introTab').classList.remove('active');
                document.getElementById('gameplayContent').classList.remove('hidden');
                document.getElementById('introContent').classList.add('hidden');
            });
            
            // Листание страниц "Как играть"
            initPagination('intro', 3);
            initPagination('gameplay', 8);
            
            // Создание игры
            const playerCountSlider = document.getElementById('playerCountSlider');
            const playerCountValue = document.getElementById('playerCountValue');
            
            playerCountSlider.addEventListener('input', () => {
                playerCountValue.textContent = playerCountSlider.value;
                gameState.playerCount = parseInt(playerCountSlider.value);
            });
            
            // Кнопки списков апокалипсисов и бункеров
            document.getElementById('apocalypseListBtn').addEventListener('click', () => {
                fillApocalypseList();
                modals.apocalypse.classList.add('active');
            });
            
            document.getElementById('bunkerListBtn').addEventListener('click', () => {
                fillBunkerList();
                modals.bunker.classList.add('active');
            });
            
            document.getElementById('createGameNextBtn').addEventListener('click', () => {
                // Генерация случайных апокалипсиса и бункера
                gameState.currentApocalypse = apocalypses[Math.floor(Math.random() * apocalypses.length)];
                gameState.currentBunker = bunkers[Math.floor(Math.random() * bunkers.length)];
                
                showScreen('chooseCharacter');
                initNumberSelector();
            });
            
            // Выбор персонажа
            document.getElementById('chooseCharacterNextBtn').addEventListener('click', () => {
                gameState.isObserver = document.getElementById('observerCheckbox').checked;
                generatePlayers();
                showScreen('shareCards');
            });
            
            // Рассылка карточек
            document.getElementById('startGameBtn').addEventListener('click', () => {
                setupGameScreen();
                showScreen('game');
            });
            
            // Игровой экран
            document.getElementById('showApocalypseBtn').addEventListener('click', () => {
                document.getElementById('apocalypseBunkerScreen').classList.remove('hidden');
            });
            
            document.getElementById('hideApocalypseBtn').addEventListener('click', () => {
                document.getElementById('apocalypseBunkerScreen').classList.add('hidden');
            });
            
            document.getElementById('finishBtn').addEventListener('click', () => {
                showFinishModal();
            });
            
            // Модальные окна
            document.querySelectorAll('.modal-close').forEach(btn => {
                btn.addEventListener('click', () => {
                    Object.values(modals).forEach(modal => modal.classList.remove('active'));
                });
            });
            
            // Финиш
            document.getElementById('threatBtn').addEventListener('click', showRandomThreat);
            document.getElementById('endGameBtn').addEventListener('click', () => {
                modals.finish.classList.remove('active');
                showScreen('main');
            });
        }
        
        // Инициализация пагинации
        function initPagination(prefix, pageCount) {
            let currentPage = 1;
            const prevBtn = document.getElementById(`${prefix}PrevBtn`);
            const nextBtn = document.getElementById(`${prefix}NextBtn`);
            
            function updateButtons() {
                prevBtn.disabled = currentPage === 1;
                nextBtn.disabled = currentPage === pageCount;
            }
            
            function showPage(page) {
                document.querySelectorAll(`[id^="${prefix}Page"]`).forEach(el => {
                    el.classList.add('hidden');
                });
                document.getElementById(`${prefix}Page${page}`).classList.remove('hidden');
                currentPage = page;
                updateButtons();
            }
            
            prevBtn.addEventListener('click', () => {
                if (currentPage > 1) showPage(currentPage - 1);
            });
            
            nextBtn.addEventListener('click', () => {
                if (currentPage < pageCount) showPage(currentPage + 1);
            });
            
            showPage(1);
        }
        
        // Заполнение списка апокалипсисов
        function fillApocalypseList() {
            const list = document.getElementById('apocalypseList');
            list.innerHTML = '';
            
            apocalypses.forEach(apocalypse => {
                const item = document.createElement('div');
                item.className = 'modal-item';
                item.innerHTML = `
                    <div class="modal-item-title">${apocalypse.name}</div>
                    <div>${apocalypse.description}</div>
                    <div><strong>Время в бункере:</strong> ${apocalypse.time}</div>
                `;
                list.appendChild(item);
            });
        }
        
        // Заполнение списка бункеров
        function fillBunkerList() {
            const list = document.getElementById('bunkerList');
            list.innerHTML = '';
            
            bunkers.forEach(bunker => {
                const item = document.createElement('div');
                item.className = 'modal-item';
                item.innerHTML = `
                    <div class="modal-item-title">${bunker.name}</div>
                    <div>${bunker.description}</div>
                    <div><strong>Местоположение:</strong> ${bunker.location}</div>
                    <div><strong>Площадь:</strong> ${bunker.area}</div>
                    <div><strong>Ресурсы:</strong> ${bunker.resources}</div>
                    <div><strong>Слабости:</strong> ${bunker.weaknesses}</div>
                `;
                list.appendChild(item);
            });
        }
        
        // Инициализация выбора номера персонажа
        function initNumberSelector() {
            const selector = document.getElementById('numberSelector');
            selector.innerHTML = '';
            
            for (let i = 1; i <= gameState.playerCount; i++) {
                const option = document.createElement('div');
                option.className = 'number-option';
                option.textContent = i;
                option.addEventListener('click', () => {
                    document.querySelectorAll('.number-option').forEach(el => {
                        el.classList.remove('selected');
                    });
                    option.classList.add('selected');
                    document.getElementById('characterNumDisplay').textContent = i;
                    gameState.selectedCharacter = i;
                });
                
                if (i === 1) option.classList.add('selected');
                selector.appendChild(option);
            }
        }
        
        // Показать экран
        function showScreen(screenName) {
            Object.values(screens).forEach(screen => {
                screen.classList.remove('active');
            });
            screens[screenName].classList.add('active');
            
            // Закрываем все модальные окна при смене экрана
            Object.values(modals).forEach(modal => modal.classList.remove('active'));
        }
        
        // Генерация игроков
        function generatePlayers() {
            gameState.players = [];
            
            for (let i = 1; i <= gameState.playerCount; i++) {
                const player = {
                    number: i,
                    profession: professions[Math.floor(Math.random() * professions.length)],
                    gender: genders[Math.floor(Math.random() * genders.length)],
                    age: Math.floor(Math.random() * 50) + 18,
                    orientation: orientations[Math.floor(Math.random() * orientations.length)],
                    health: healthConditions[Math.floor(Math.random() * healthConditions.length)],
                    character: characters[Math.floor(Math.random() * characters.length)],
                    hobby: hobbies[Math.floor(Math.random() * hobbies.length)],
                    phobia: phobias[Math.floor(Math.random() * phobias.length)],
                    extra: extraInfos[Math.floor(Math.random() * extraInfos.length)],
                    knowledge: knowledgeCards[Math.floor(Math.random() * knowledgeCards.length)],
                    luggage: luggageItems[Math.floor(Math.random() * luggageItems.length)],
                    actionCard: actionCards[Math.floor(Math.random() * actionCards.length)],
                    conditionCard: conditionCards[Math.floor(Math.random() * conditionCards.length)]
                };
                
                gameState.players.push(player);
            }
            
            // Обновляем список игроков на экране рассылки
            const playersList = document.getElementById('playersList');
            playersList.innerHTML = '';
            
            gameState.players.forEach(player => {
                const playerElement = document.createElement('div');
                playerElement.className = 'player-card';
                playerElement.innerHTML = `
                    <div>Игрок ${player.number}</div>
                    <button class="btn btn-outline share-btn" data-player="${player.number}">Поделиться</button>
                `;
                playersList.appendChild(playerElement);
            });
            
            // Обработчики для кнопок "Поделиться"
            document.querySelectorAll('.share-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const playerNum = parseInt(this.getAttribute('data-player'));
                    const player = gameState.players.find(p => p.number === playerNum);
                    
                    if (player) {
                        const playerInfo = `
Игрок ${player.number}
Профессия: ${player.profession}
Возраст: ${player.age}
Пол: ${player.gender}
Ориентация: ${player.orientation}
Характер: ${player.character}
Здоровье: ${player.health}
Хобби: ${player.hobby}
Фобия: ${player.phobia}
Доп. инфо: ${player.extra}
Знание: ${player.knowledge}
Багаж: ${player.luggage}
Карта действия: ${player.actionCard}
Карта условия: ${player.conditionCard}

Катастрофа: ${gameState.currentApocalypse.name}
${gameState.currentApocalypse.description}

Бункер: ${gameState.currentBunker.name}
${gameState.currentBunker.description}
Местоположение: ${gameState.currentBunker.location}
Ресурсы: ${gameState.currentBunker.resources}
Слабости: ${gameState.currentBunker.weaknesses}
                        `;
                        
                        // Копирование в буфер обмена
                        navigator.clipboard.writeText(playerInfo).then(() => {
                            alert(`Карточка игрока ${player.number} скопирована в буфер обмена! Теперь вы можете отправить её игроку через Telegram.`);
                        });
                    }
                });
            });
        }
        
        // Настройка игрового экрана
        function setupGameScreen() {
            // Установка катастрофы и бункера
            document.getElementById('apocalypseDescription').textContent = 
                `${gameState.currentApocalypse.name}\n${gameState.currentApocalypse.description}`;
                
            document.getElementById('bunkerName').textContent = gameState.currentBunker.name;
            document.getElementById('bunkerSize').textContent = gameState.currentBunker.area;
            document.getElementById('bunkerSlots').textContent = Math.floor(gameState.playerCount / 2);
            document.getElementById('bunkerTime').textContent = gameState.currentApocalypse.time;
            document.getElementById('bunkerDescription').textContent = gameState.currentBunker.description;
            document.getElementById('bunkerLocation').textContent = gameState.currentBunker.location;
            document.getElementById('bunkerResources').textContent = gameState.currentBunker.resources;
            document.getElementById('bunkerWeaknesses').textContent = gameState.currentBunker.weaknesses;
            
            // Установка текущего игрока
            updatePlayerCard(gameState.selectedCharacter);
            
            // Создание кнопок для переключения игроков
            const playerSlider = document.getElementById('playerSlider');
            playerSlider.innerHTML = '';
            
            for (let i = 1; i <= gameState.playerCount; i++) {
                const btn = document.createElement('div');
                btn.className = 'player-dot';
                btn.textContent = i;
                if (i === gameState.selectedCharacter) btn.classList.add('active');
                
                btn.addEventListener('click', () => {
                    if (i !== gameState.selectedCharacter && !gameState.isObserver) {
                        if (confirm("Вы уверены что хотите посмотреть характеристики другого игрока?")) {
                            updatePlayerCard(i);
                        }
                    } else {
                        updatePlayerCard(i);
                    }
                });
                
                playerSlider.appendChild(btn);
            }
        }
        
        // Обновление карточки игрока
        function updatePlayerCard(playerNumber) {
            const player = gameState.players.find(p => p.number === playerNumber);
            if (!player) return;
            
            document.getElementById('playerNum').textContent = player.number;
            document.getElementById('playerProfession').textContent = player.profession;
            document.getElementById('playerAge').textContent = `${player.age} год`;
            document.getElementById('playerGender').textContent = player.gender;
            document.getElementById('playerOrientation').textContent = player.orientation;
            document.getElementById('playerHealth').textContent = player.health;
            document.getElementById('playerCharacter').textContent = player.character;
            document.getElementById('playerHobby').textContent = player.hobby;
            document.getElementById('playerPhobia').textContent = player.phobia;
            document.getElementById('playerExtra').textContent = player.extra;
            document.getElementById('playerKnowledge').textContent = player.knowledge;
            document.getElementById('playerLuggage').textContent = player.luggage;
            document.getElementById('playerActionCard').textContent = player.actionCard;
            document.getElementById('playerConditionCard').textContent = player.conditionCard;
            
            // Обновление активной кнопки
            document.querySelectorAll('.player-dot').forEach(btn => {
                if (parseInt(btn.textContent) === playerNumber) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }
        
        // Показать случайную угрозу
        function showRandomThreat() {
            const threat = threats[Math.floor(Math.random() * threats.length)];
            document.getElementById('threatModalDescription').textContent = threat;
            modals.threat.classList.add('active');
        }
        
        // Показать модальное окно финиша
        function showFinishModal() {
            modals.finish.classList.add('active');
            
            const list = document.getElementById('finishPlayerList');
            list.innerHTML = '';
            
            gameState.players.forEach(player => {
                const isEjected = gameState.ejectedPlayers.includes(player.number);
                const item = document.createElement('div');
                item.className = 'finish-player-item';
                item.innerHTML = `
                    <div>Игрок ${player.number} ${isEjected ? '(выбыл)' : ''}</div>
                    <button class="btn btn-small ${isEjected ? 'btn-outline' : 'btn-danger'}" 
                            data-player="${player.number}">
                        ${isEjected ? 'Вернуть' : 'Выкинуть'}
                    </button>
                `;
                list.appendChild(item);
                
                // Обработчик кнопки выкинуть/вернуть
                const button = item.querySelector('button');
                button.addEventListener('click', function() {
                    const playerNum = parseInt(this.getAttribute('data-player'));
                    
                    if (gameState.ejectedPlayers.includes(playerNum)) {
                        // Вернуть игрока
                        gameState.ejectedPlayers = gameState.ejectedPlayers.filter(num => num !== playerNum);
                        this.textContent = 'Выкинуть';
                        this.classList.remove('btn-outline');
                        this.classList.add('btn-danger');
                    } else {
                        // Выкинуть игрока
                        gameState.ejectedPlayers.push(playerNum);
                        this.textContent = 'Вернуть';
                        this.classList.remove('btn-danger');
                        this.classList.add('btn-outline');
                    }
                    
                    // Обновляем статус игрока
                    const playerText = item.querySelector('div');
                    playerText.innerHTML = `Игрок ${playerNum} ${gameState.ejectedPlayers.includes(playerNum) ? '(выбыл)' : ''}`;
                });
            });
        }
        
        // Запуск игры при загрузке
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
